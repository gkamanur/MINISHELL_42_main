# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: gkamanur <gkamanur@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/07/28 13:54:06 by robello           #+#    #+#              #
#    Updated: 2025/08/21 11:19:49 by gkamanur         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #


NAME = minishell
BONUS_NAME = minishell_bonus

CC = cc

LIBFT_DIR       	:= libft
GET_NEXT_LINE_DIR 	:= gnl
BUILT_DIR 			:= built
EXEC_DIR      		:= execute
EXPAN_DIR   		:= expansion
LEXER_DIR 			:= lexer
PIPE_DIR     		:= pipe
PARSE_DIR     		:= parser
MAIN_DIR     		:= src


CFLAGS = -g -Wall -Wextra -Werror -I$(LIBFT_DIR) -I$(GET_NEXT_LINE_DIR)

SRC_DIR = src
BONUS_SRC_DIR = src_bonus
# include source.list



SRC =	\
	$(wildcard $(LIBFT_DIR)/*.c) \
	$(wildcard $(GET_NEXT_LINE_DIR)/*.c) \
	$(wildcard $(BUILT_DIR)/*.c) \
	$(wildcard $(EXPAN_DIR)/*.c) \
	$(wildcard $(LEXER_DIR)/*.c) \
	$(wildcard $(PIPE_DIR)/*.c) \
	$(wildcard $(PARSE_DIR)/*.c) \
	$(wildcard $(EXEC_DIR)/*.c) \
	$(wildcard $(MAIN_DIR)/*.c) 

BONUS_SRC =	$(BONUS_SRC_DIR)/main_bonus.c \
			$(BONUS_SRC_DIR)/parser_bonus.c \
			$(BONUS_SRC_DIR)/lexer_bonus.c \
			$(BONUS_SRC_DIR)/utils_bonus.c \
			$(BONUS_SRC_DIR)/execute_bonus.c \
			$(GET_NEXT_LINE_DIR)/get_next_line_bonus.c \
			$(GET_NEXT_LINE_DIR)/get_next_line_utils_bonus.c

OBJ = $(SRC:.c=.o)
BONUS_OBJ = $(BONUS_SRC:.c=.o)

LIBFT = $(LIBFT_DIR)/libft.a

GREEN = \033[0;32m
RESET = \033[0m
all: $(NAME)

$(NAME): $(OBJ) | $(LIBFT)
	@$(CC) $(CFLAGS) $(OBJ) $(LIBFT) -lreadline -o $@
	@printf "$(GREEN)***** MINISHELL PROGRAM CREATED SUCCESSFULLY *****$(RESET)\n"

$(BONUS_NAME): $(BONUS_OBJ) | $(LIBFT)
	@$(CC) $(CFLAGS) -DBONUS $(BONUS_OBJ) $(LIBFT) -lreadline -o $@
	@printf "$(GREEN)***** MINISHELL BONUS PROGRAM CREATED SUCCESSFULLY *****$(RESET)\n"

%.o: %.c
	@$(CC) $(CFLAGS) -c $< -o $@
	@echo "Compiled $<"

$(LIBFT):
	@echo "Building libft with bonus..."
	@$(MAKE) -C $(LIBFT_DIR) bonus
	@echo "LIBFT built with Bonus."

clean:
	@rm -f $(OBJ) $(BONUS_OBJ)
	@$(MAKE) -C $(LIBFT_DIR) clean
	@echo "--Cleaned all .o files--"

fclean: clean
	@rm -f $(NAME) $(BONUS_NAME)
	@$(MAKE) -C $(LIBFT_DIR) fclean
	@echo "--Fully Cleaned Successfully--"


re: fclean all
bonus: $(BONUS_NAME)

.PHONY: all clean fclean re bonus
